<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
</head>
<body>
    <h1>API Test</h1>
    <button onclick="testAPI()">Test API</button>
    <div id="result"></div>

    <script>
        async function testAPI() {
            console.log('🧪 Testing API after permission refresh...');
            console.log('🌐 Origin:', window.location.origin);
            console.log('📍 Full URL:', window.location.href);
            
            try {
                const apiUrl = 'https://script.google.com/macros/s/AKfycbxK0Ja9rVcO_yy1YoP4zsGiuMiv-qKpWiSNqW3dyh_JU2JhJuhnJ5GwvCWQYLw9pnd3/exec';
                console.log('🚀 Fetching:', apiUrl);
                
                const response = await fetch(apiUrl);
                console.log('✅ Response received:', response.status, response.statusText);
                console.log('📋 Response headers:', [...response.headers.entries()]);
                
                const data = await response.json();
                console.log('📊 Data received:', data);
                document.getElementById('result').innerHTML = `✅ SUCCESS: Found ${data.count} songs!`;
                document.getElementById('result').style.color = 'green';
            } catch (error) {
                console.error('❌ Error details:', error);
                console.error('❌ Error stack:', error.stack);
                document.getElementById('result').innerHTML = `❌ ERROR: ${error.message}`;
                document.getElementById('result').style.color = 'red';
            }
        }
    </script>
</body>
</html>
